kind create cluster --config kind_example.yaml 

docker build -t my-static-nginx:latest .

kind load docker-image my-static-nginx:latest --name kind

kubectl config get-contexts

helm repo add prometheus-community https://prometheus-community.github.io/helm-charts


kubectl create namespace monitoring

helm install prometheus-stack prometheus-community/kube-prometheus-stack --namespace monitoring

kubectl get crd servicemonitors.monitoring.coreos.com

kubectl get pods,svc,deployment,servicemonitor -o wide


kubectl port-forward service/my-static-site-my-static-site 8080:80


pip -m  venv venv

source venv/bin/activate

locust


docker build -t my-static-nginx:5rps-burst .
kind load docker-image my-static-nginx:5rps-burst
kubectl set image deployment/my-static-site-my-static-site nginx=my-static-nginx:5rps-burst




victor@keler:~/Desktop/kind-example/test_work$ # Тест в течение 10 секунд
start_time=$(date +%s)
success=0
total=0

for i in {1..100}; do
  result=$(curl -s -w "%{http_code}" -o /dev/null http://localhost:8080)
  total=$((total + 1))
  
  if [ "$result" == "200" ]; then
    success=$((success + 1))
  fi
  
echo "Фактический RPS: $actual_rps"cess из $total запросов"
За 12s: успешно 65 из 100 запросов
Фактический RPS: 5.41
